build:
    box: node:10.9.0
    steps:

    # Check that our application's tests are passing. Since this is a python
    # application, our entry script will also install the application's dependencies
    # with Virtualenv
    
    - internal/docker-build:
      dockerfile: Dockerfile
      image-name: $REPO_REPOSITORY:$WERCKER_GIT_COMMIT
      no-cache: true
      registry-auth-config: |
        {
          "https://iad.ocir.io/v2/": {
            "username": "${REPO_USERNAME}",
            "password": "${REPO_PASSWORD}"
          }
        }
    # push the image to Docker using the GIT branch as the tag
    - internal/docker-push:
      image-name: $REPO_REPOSITORY:$WERCKER_GIT_COMMIT
      username: $REPO_USERNAME
      password: $REPO_PASSWORD
      repository: $REPO_REPOSITORY
      registry: $REPO_REGISTRY
      tag: $WERCKER_GIT_COMMIT
